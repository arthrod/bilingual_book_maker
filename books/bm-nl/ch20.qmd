# Geld losmaken van de staat

In 1984 verklaarde de Nobelprijswinnaar in economie Friedrich Hayek tijdens een interview:

> Ik geloof niet dat we ooit weer goed geld zullen hebben, voordat we het uit de handen van de overheid nemen. Aangezien we het niet op gewelddadige wijze van de overheid kunnen afpakken, kunnen we alleen maar op een sluwe manier iets introduceren dat ze niet kunnen stoppen.[^307]

Hoewel zo'n uitspraak in eerste instantie extreem klinkt, lijkt deze minder radicaal wanneer je bedenkt dat er wereldwijd ongeveer 160 valuta's bestaan, waarvan de meeste snel in waarde dalen en nauwelijks buiten hun eigen monopolies worden geaccepteerd.

Overheid en geld worden in de moderne geschiedenis vaak met elkaar geassocieerd, maar net zoals overheid en religie hoeven ze niet per definitie nauw verweven te zijn. Zelfs als er wel een band bestaat, sluit dit privéalternatieven niet uit. In veel ontwikkelingslanden kiezen mensen herhaaldelijk voor dollars of goud, omdat deze voor enige stabiliteit zorgen in plaats van het vertrouwen op onstabiele lokale valuta.

Decennialang – van de jaren '80 tot en met de jaren 2000 – zochten programmeurs naar manieren om digitaal geld te creëren, onafhankelijk van de staat, met behulp van cryptografie via het internet. Hun pogingen kenden wisselende en tijdelijke successen, die vaak leidden tot mislukking of stagnatie, maar legden desondanks de basis voor latere ontwikkelingen.[^308]

In 1982 publiceerde de computerwetenschapper en cryptograaf David Chaum zijn proefschrift aan Berkeley, getiteld *Computer Systems Established, Maintained, and Trusted by Mutually Suspicious Groups*.[^309] Hierin onderzocht hij hoe entiteiten die elkaar niet per se vertrouwen, gezamenlijk een gedeelde database konden onderhouden met behulp van cryptografische technieken. In 1983 introduceerde hij e-cash, dat gebruikmaakte van 'blind signatures' (blinde handtekeningen) om elektronische transacties privé mogelijk te maken. Hierdoor kon zelfs de partij die de transactie verwerkte de details niet inzien, maar deze wel verwerken met behulp van wiskundige bewijzen.[^310] In 1989 richtte hij vervolgens DigiCash op om dit commercieel toe te passen, maar dit bleek niet succesvol; weinig handelaren en particulieren waren bereid dit betaalmiddel te aanvaarden, waardoor een zelfversterkend netwerkeffect uitbleef. In 1998 ging DigiCash failliet, en in 1999 citeerde een *Forbes*-artikel Chaum: 'Het was moeilijk om genoeg handelaren te vinden die het wilden accepteren, zodat je voldoende consumenten kon bereiken, of andersom.'[^311] Hij merkte daarbij ook op dat privacy bij transacties steeds minder belangrijk werd naarmate meer mensen internet gingen gebruiken en de gemiddelde technische vaardigheid afnam.

In 1989 werd het Hypertext Transfer Protocol (HTTP) ontwikkeld. De meeste mensen zijn bekend met foutcodes als de bekende 'HTTP 404 Not Found', die verschijnt wanneer een niet-bestaande webpagina wordt bezocht – vaak door een typefout of doordat de pagina is verwijderd. Een veel minder bekende oorspronkelijke foutcode is 'HTTP 402 Payment Required' (Betaling Vereist), gereserveerd voor toekomstig gebruik in verband met digitale betalingen. Decennialang werd deze code echter niet ingezet, zelfs niet in het tijdperk van e-commerce, omdat online betalingen destijds doorgaans via banken werden afgehandeld met een extra internetlaag, in plaats van met een inheems digitaal betaalsysteem.

In 1996 lanceerde Gold and Silver Reserve Inc. (G&SR) e-gold, waarmee gebruikers via de bedrijfswebsite een online rekening konden openen, uitgedrukt in grammen goud. Hierdoor konden zij direct, zelfs in fracties van een gram, waarde overdragen naar andere rekeningen. Op zijn hoogtepunt telde e-gold meer dan 5 miljoen rekeningen en kende het een jaarlijkse overdrachtswaarde van 2 miljard dollar. In de jaren 2000 kreeg het bedrijf echter te maken met juridische problemen: na de aanslagen van 11 september breidde de Amerikaanse federale regering onder de Patriot Act de regelgeving voor geldtransmissiebedrijven uit. Als gevolg hiervan klaagde de overheid het bedrijf aan, en tegen 2009 werd e-gold stilgelegd.[^312] Deze episode illustreert het eerder besproken probleem rond goud: om snel verplaatst te kunnen worden, moet goud worden geabstraheerd via een gecentraliseerde bewaarinrichting, die vervolgens vatbaar is voor corruptie of bemoeienis.

Aan het einde van de jaren '90 en het begin van de jaren 2000 werden enkele belangrijke stappen gezet op het gebied van digitale schaarste. In 1997 ontwikkelde Adam Back het proof-of-work-systeem Hashcash, bedoeld om spam en denial-of-service (DoS)-aanvallen te beperken. Het principe van proof-of-work bestaat eruit om met aanzienlijke rekenkracht een digitaal token of certificaat te genereren, dat vervolgens door iedere partij eenvoudig te verifiëren is als authentiek. Daarna stelde Nick Szabo het concept *Bit Gold* voor, waarbij deze onvervalsbare kosten werden ingezet om een schaars digitaal bezit te creëren. In 2004 combineerde Hal Finney zowel Hashcash als het idee van Bit Gold in een innovatie genaamd Reusable Proof of Work (RPOW). Via een gecentraliseerde server transformeerde Finney Hashcash in een herbruikbare token, een soort verifieerbaar schaars digitaal object, dat hij RPOW-tokens noemde.[^313] Hoewel er in die tijd ook andere voorstellen voor digitale valuta waren, bleek dit traject van Back, Szabo en Finney bijzonder invloedrijk.

Een belangrijke beperking van de meeste van deze monetaire initiatieven was hun gecentraliseerde aard. DigiCash slaagde er niet in als gecentraliseerd bedrijf een netwerkeffect te realiseren. Ook al kende e-gold aanvankelijk succes, het werd stopgezet door overheidsingrijpen. Bovendien opereerden de RPOW-tokens eveneens op een gecentraliseerde server.

In 2008 implementeerde een onbekende ontwikkelaar of groep, opererend onder het pseudoniem Satoshi Nakamoto, enkele van deze methoden op een gedecentraliseerde wijze. Op 31 oktober 2008 presenteerde Satoshi een witboek met de titel *Bitcoin: A Peer-to-Peer Electronic Cash System* aan een cryptografische mailinglijst, waarop ook enkele van de eerdergenoemde experts aanwezig waren, naast vele anderen.

Het abstract luidde als volgt:

> Een zuivere vorm van elektronisch geld, rechtstreeks van persoon tot persoon, maakt het mogelijk om online betalingen direct tussen partijen te verrichten zonder tussenkomst van een financiële instelling. Digitale handtekeningen leveren een gedeelte van de oplossing, maar als er nog steeds een vertrouwde derde partij nodig is om dubbele uitgaven te voorkomen, verliezen zij hun voordeel. Wij bieden een oplossing voor het probleem van dubbele uitgaven middels een peer-to-peer netwerk. Het netwerk voorziet elke transactie van een tijdstempel door deze te hashen in een doorlopende keten van hash-gebaseerd proof-of-work, waardoor een verslag ontstaat dat niet gewijzigd kan worden, tenzij het proof-of-work opnieuw wordt uitgevoerd. De langste keten bewijst niet alleen de volgorde van de waargenomen gebeurtenissen, maar ook dat deze keten afkomstig is van de grootste bron van rekenkracht. Zolang de meerderheid van de rekenkracht in handen is van nodes die niet samenspannen om het netwerk aan te vallen, zullen zij de langste keten genereren en aanvallers buiten spel zetten. Het netwerk vereist minimale structurering: berichten worden via een 'best effort'-methode verzonden, en nodes kunnen het netwerk naar eigen believen verlaten en opnieuw toetreden, waarbij zij de langste proof-of-work keten accepteren als bewijs van de gebeurtenissen.[^314]

Het negen pagina's tellende witboek was in een academische stijl geschreven en bevatte acht verwijzingen naar diverse cryptografische en tijdstempeltechnieken, waaronder Adam Back's Hashcash. In de daaropvolgende weken bestudeerden meerdere cryptografen het artikel op de mailinglijst en stelden – vaak kritisch en sceptisch – vragen, waarop Satoshi beleefd reageerde.[^315] De inmiddels openbaar gemaakte e-mails geven het gevoel alsof men een proefschriftverdediging bijwoonde, met weloverwogen vragen en gedegen antwoorden van professionals.

Satoshi deed op geen enkel moment de belofte van rijkdom of assumeerde hij de rol van verkoper. Hij schreef als een academicus en benadrukte dat het doel van zijn werk was om vrijheid te bevorderen, in de geest van de cypherpunk-beweging.

Een deelnemer op de mailinglijst merkte op: 'Je zult geen oplossing vinden voor politieke problemen in cryptografie.' Satoshi antwoordde daarop: 'Wel, we kunnen een belangrijke slag winnen in de wapenwedloop en een nieuw domein van vrijheid veroveren voor vele jaren. Overheden zijn bedreven in het uitschakelen van centraal gecontroleerde netwerken, zoals Napster, maar pure peer-to-peer netwerken zoals Gnutella en Tor blijken stand te houden.'[^316]

Op 9 januari 2009 bracht Satoshi de open-source code uit en voerde hij het minen van het eerste blok uit. In het zogeheten genesisblok verwees hij naar een recente krantenkop over de redding van Britse banken tijdens het hoogtepunt van de wereldwijde financiële crisis.

> 'The Times 03/Jan/2009 Minister van Financiën op het punt om banken voor de tweede keer te redden'[^317]

Op 10 januari liet Hal Finney via een tweet weten dat hij de Bitcoin-software had geïnstalleerd. Kort daarna ontving hij de allereerste testtransactie van Satoshi.[^318]

Gedurende de eerste twee jaar – in 2009 en 2010 – bleef Satoshi de code bijwerken en trad hij in gesprek over diverse concepten met vroege gebruikers. Hij stond bekend om zijn kalme en feitelijke benadering. Eind 2010 verdween Satoshi en publiceerde hij verder niets, waarmee hij het project aan anderen overliet.[^319] Tot op heden is zijn identiteit onbekend, en sindsdien werkt een voortdurende groep ontwikkelaars aan het Bitcoinnetwerk.

Bitcoin is een gedistribueerd openbaar grootboek, door sommigen aangeduid als *triple-entry bookkeeping*. Het protocol stelt deelnemers wereldwijd in staat om ongeveer elke tien minuten consensus te bereiken over de status van het grootboek. Iedereen met een goedkope laptop en een internetverbinding kan als nodebeheerder deelnemen door een gratis en open-source applicatie te draaien. Hierdoor kunnen zij transacties rechtstreeks verzenden en ontvangen, zonder tussenkomst van een gecentraliseerde instantie. Delvers ontvangen transactiekosten en nieuwe bitcoin voor het verwerken van nieuwe blokken met transacties op het netwerk (updates van het grootboek), waarbij zij gebruikmaken van proof-of-work en tijdstempels. Nodebeheerders verifiëren of deze nieuwe blokken voldoen aan de netwerkregels. Aangezien het grootboek sterk gedistribueerd is en relatief weinig data bevat, kunnen nodebeheerders een volledige kopie van het grootboek opslaan en deze voortdurend synchroniseren met de rest van het netwerk. Gebruikers kunnen hun eigen privésleutels bewaren, waarmee zij, samen met nodetoepassingen, munten (of fracties van munten, meestal 'sats' genoemd, een afkorting van 'satoshis') van hun adres naar een ander adres kunnen overdragen zonder tussenkomst van een derde partij. Of mensen kunnen er ook voor kiezen om hun sleutels aan een bewaarder toe te vertrouwen, zodat zij op een vergelijkbare wijze met bitcoin kunnen omgaan als met een bankrekening. Het totale aantal bitcoin dat uiteindelijk zal bestaan, bedraagt 21 miljoen, welke is opgedeeld in 2,1 quadriljoen sats.

Dit is een bijzonder krachtig concept. Een bitcoingebruiker kan bijvoorbeeld een reeks van twaalf woorden onthouden (die zijn privésleutel vertegenwoordigen) en daarmee haar digitale tegoed wereldwijd meenemen, zonder afhankelijk te zijn van een centrale tegenpartij. Bitcoin is een gedecentraliseerd grootboek, opgebouwd uit een wereldwijde cloud van computers. Dit grootboek is bijna onmogelijk aan te vallen en de spelregels kunnen niet eenzijdig worden aangepast, want er is geen centrale server of uitgever. Het systeem is volledig transparant, wat inhoudt dat iedere regel code openbaar is. Ontwikkelaars kunnen gezamenlijk werken aan updates te ontwikkelen en voor te stellen, maar updates kunnen niet opgedrongen worden aan gebruikers; zij worden enkel vrijwillig geaccepteerd en moeten achterwaarts compatibel zijn als men deel wil blijven uitmaken van het bestaande netwerk.

Daarnaast overbrugt Bitcoin het verschil in snelheid tussen transacties en afwikkelingen – een onderwerp dat ik reeds herhaaldelijk in dit boek aan de orde heb gesteld. Sinds de tweede helft van de 19e eeuw, met de introductie van intercontinentale telecommunicatiesystemen, kunnen transacties in principe met de snelheid van het licht de wereld rondgaan. Daarentegen kon schaars, zelfbeheerd geld zoals goud slechts met de snelheid van materie worden verplaatst en gecontroleerd. Dit snelheidsverschil bood banken en overheden grote arbitragemogelijkheden, waardoor zij monopolies kregen over snelle langeafstandsbetalingen. Bitcoin biedt voor het eerst een effectieve manier om schaarse waarde met de snelheid van het licht af te wikkelen. Verzonden bitcoin wordt onomkeerbaar zodra deze binnen enkele blokken op de blockchain is verwerkt, tenzij meer dan 50% van de wereldwijd verspreide delvers dit probeert terug te draaien. Een bitcoin is een schaars goed dat geen tussenkomst van een derde partij behoeft, vergelijkbaar met een goudstaaf. De mogelijkheid om een niet-verplichtend goed razendsnel over grote afstanden te verplaatsen is iets dat de wereld nog nooit eerder heeft gezien.

In hoofdstuk 8 besprak ik de beschrijving van William Stanley Jevons uit 1875, waarin hij een gecentraliseerd wereldwijd clearinghouse voorstelde waarmee alle entiteiten snel konden afrekenen. Hoewel zijn visie steeds meer werkelijkheid werd – eerst in Londen, daarna in New York – bleef het fundamentele probleem dat dit clearinghouse was gebaseerd op abstractie en schuld, wat aanzienlijk wanbeheer van het grootboek mogelijk maakte. Bitcoin kan fungeren als een gedecentraliseerd wereldwijd clearinghouse, omdat de drageractiva hier direct tussen entiteiten kunnen worden vereffend, zonder afhankelijk te zijn van abstractie en schuld, en dit binnen enkele minuten.[^320]

Het is geen toeval dat het ongeveer anderhalve eeuw duurde voordat, na de mogelijkheid om transacties met de snelheid van het licht te verrichten, ook de afwikkeling van drageractiva met dezelfde snelheid plaatsvond. Dit proces was afhankelijk van eerdere ontwikkelingen, net zoals de uitvinding van de fiets noodzakelijk voorafging aan die van de auto. Transacties op basis van krediet via telecommunicatiesystemen vereisten slechts eenvoudige data, zoals Morsecode, en waren daardoor al in de 19e eeuw mogelijk. De afwikkeling van schaarse waarde via telecommunicatiesystemen vereist echter veel complexere berekeningen, datastructuren, bandbreedte en wiskundige bewijzen. Bitcoin en de bredere concepten van digitale schaarste en een gedecentraliseerd digitaal afwikkelingsnetwerk werden vrijwel zo snel mogelijk ontwikkeld, rekening houdend met de timing van de onderliggende technologieën.

Als ik zou moeten uitleggen waarom geld wereldwijd zo lang defect bleef, terwijl bijna alles op andere vlakken enorm verbeterd is (denk aan de overvloed aan energie en technologische ontwikkelingen), dan ligt dat aan het snelheidsverschil tussen transacties en afwikkelingen dat het telecommunicatietijdperk heeft gecreëerd. De wereld zat anderhalve eeuw vast in een lokaal optimum dat steeds complexere vormen van gecentraliseerde abstractie vereiste en stimuleerde om die kloof te overbruggen. De internationale goudstandaard functioneerde tijdens vredestijd decennialang, maar was vanaf het begin inherent gebrekkig omdat zij talloze claims op een beperkte geldbasis van daadwerkelijk goud mogelijk maakte; bij de eerste test, wanneer oorlog uitbrak tussen grote machten in Europa, stortte het in. Het Bretton Woods-systeem bleek nog gebrekkiger door de nog grotere mate van abstractie en mislukte binnen minder dan 15 jaar na volledige implementatie. Het moderne systeem, met 160 fiatvaluta's die steeds verder in waarde dalen en los staan van een enkele wereldreservevaluta, is zeer gebrekkig omdat er geen inherente basis in schaarste is. De introductie van Bitcoin als een open-source snel afwikkelingsnetwerk met eigen schaarse eenheden biedt de eerste geloofwaardige manier om die kloof tussen transactie- en afwikkelingssnelheden te dichten. Nu is het een kwestie van onderzoeken en testen of het systeem robuust genoeg is om deze functie op grote schaal op de lange termijn te vervullen.

## Overzicht van Bitcoin's technologie

Satoshi vatte Bitcoin samen in een forumbericht in februari 2009, ongeveer een maand na de release. Sindsdien zijn er duizenden artikelen en talloze boeken over Bitcoin verschenen, maar ik ben van mening dat Satoshi's eigen beschrijving nog steeds nuttig is vanwege de helderheid.

> Ik heb een nieuw, open-source P2P e-cashsysteem ontwikkeld, genaamd Bitcoin. Het systeem is volledig gedecentraliseerd, zonder centrale server of betrouwbare derde partijen, omdat het geheel gebaseerd is op cryptografisch bewijs in plaats van op vertrouwen. Probeer het gerust uit, of bekijk de screenshots en het ontwerpdocument:
>
> Download Bitcoin v0.1 op http://www.bitcoin.org
>
> Het fundamentele probleem met conventionele valuta is dat er een enorm vertrouwen nodig is om ze te laten functioneren. We moeten erop vertrouwen dat de centrale bank de valuta niet zal devalueren, maar de geschiedenis van fiatgeld staat vol met gevallen waarin dat vertrouwen is geschonden. We moeten erop vertrouwen dat banken ons geld veilig bewaren en het elektronisch overmaken, maar ze lenen het uit in golven van kredietbubbels met een minimale reserve. We moeten erop vertrouwen dat ze onze privacy respecteren en dat ze identiteitsdieven niet toestaan om onze rekeningen leeg te halen. Hun enorme overheadkosten maken micropayments onmogelijk.
>
> Een generatie geleden ondervonden multi-user time-sharing computersystemen een vergelijkbaar probleem. Voordat sterke encryptie beschikbaar was, moesten gebruikers vertrouwen op wachtwoordbeveiliging om hun bestanden te beschermen, en vertrouwden zij op de systeembeheerder om hun informatie privé te houden. De beheerder had altijd de mogelijkheid om de privacy te schenden, op basis van eigen oordeel – afwegend tussen privacy en andere belangen, of op bevel van zijn superieuren. Toen werd sterke encryptie voor de massa beschikbaar, en werd vertrouwen minder noodzakelijk. Gegevens konden dan op een veel veiligere wijze worden beveiligd...
>
> Nu is het tijd om hetzelfde te bewerkstelligen voor geld. Met een elektronische valuta die gebaseerd is op cryptografisch bewijs, en die geen tussenkomst vereist van een derde partij, kan geld veilig worden beheerd en kunnen transacties moeiteloos verlopen.
>
> Een van de fundamentele bouwstenen voor een dergelijk systeem is het gebruik van digitale handtekeningen. Een digitale munt bevat de publieke sleutel van zijn eigenaar. Om deze munt over te dragen, ondertekent de eigenaar deze samen met de publieke sleutel van de volgende ontvanger. Iedereen kan vervolgens de handtekeningen verifiëren om de eigendomsketen vast te stellen. Dit systeem werkt uitstekend om eigendom veilig te stellen, maar laat één krachtig probleem onopgelost: dubbele uitgaven. Iedere eigenaar zou kunnen proberen een reeds gebruikte munt opnieuw uit te geven door deze opnieuw te ondertekenen voor een andere ontvanger. De gangbare oplossing houdt in dat een vertrouwd bedrijf via een centrale database controleert op dubbele uitgaven, maar dat vereist hetzelfde basisprincipe van vertrouwen. In zo'n centrale positie kan dat bedrijf immers de gebruikers overrulen en bovendien extra kosten in rekening brengen.
>
> De oplossing van Bitcoin is dan ook het inzetten van een peer-to-peer netwerk om dubbele uitgaven te voorkomen. In wezen functioneert het netwerk als een gedistribueerde tijdstempelserver; de allereerste transactie die een munt uitgeeft, wordt gestempeld. Het netwerk maakt gebruik van het feit dat informatie gemakkelijk verspreid maar moeilijk onderdrukt kan worden. Voor een uitgebreide uitleg over de werking hiervan, zie het ontwerpdocument op http://www.bitcoin.org/bitcoin.pdf.
>
> Het resultaat is een gedistribueerd systeem zonder een enkel punt van falen. Gebruikers beheren hun eigen geld via de cryptografische sleutels en verrichten directe transacties met elkaar, terwijl het P2P-netwerk dubbele uitgaven controleert.
>
> Satoshi Nakamoto [^321]

Met die beschrijving in gedachten gaan de volgende alinea's dieper in op de werking van het Bitcoinnetwerk. Lezers hoeven niet elk detail te doorgronden, want de technische diepgang is zelfs complexer – toch is het nuttig om de kernbegrippen op gemiddeld niveau door te nemen. Ik doe mijn best dit in eenvoudige taal uit te leggen. In dit boek schrijf ik het woord 'Bitcoin' met een hoofdletter wanneer ik naar het netwerk verwijs en met een kleine letter wanneer ik de valuta—de 'bitcoin'—bedoel (tenzij het uiteraard het eerste woord van een zin betreft).

Bitcoin begon met een genesisblok en een downloadbare open‑source softwaretoepassing, ontwikkeld door Satoshi, waarmee iedereen zijn eigen node op het netwerk kan draaien. Het genesisblok, evenals alle volgende blokken, bevat een cryptografische puzzel – in feite een enorm verborgen getal – die alleen opgelost kan worden door de juiste oplossing herhaaldelijk te raden met behulp van rekenkracht. Dit proces wordt doorgaans 'delven' of 'mining' genoemd, al zou 'tijdstempelen' een nauwkeurigere omschrijving kunnen zijn. Iedereen kan in principe de rekenkracht van zijn computer inzetten om de puzzel op te lossen, maar in de praktijk worden tegenwoordig vrijwel uitsluitend gespecialiseerde SHA‑256‑processors ingezet vanwege hun hogere efficiëntie. Degene die de puzzel doorbreekt, mag een nieuw blok—gevuld met transacties—aan de bestaande keten koppelen en wordt beloond met zowel de transactiekosten als een vastgesteld aantal nieuw gegenereerde munten. Deze stimulans moedigt aan tot het inzetten van rekenkracht, en het nieuwe blok genereert tevens een nieuwe puzzel om het proces in stand te houden.

Het Bitcoinnetwerk maakt gebruik van openbare-sleutelcryptografie. Een gebruiker genereert willekeurig een privésleutel – in wezen een enorm getal. Je zou bijvoorbeeld een sleutel kunnen genereren door 256 keer een munt op te gooien, maar de meeste mensen maken in de praktijk gebruik van software‐wallets die dit automatisch voor hen regelen. Er bestaan immers meer mogelijke privésleutels dan er atomen zijn in een miljoen sterrenstelsels, waardoor de kans om per toeval een reeds gebruikte sleutel te creëren verwaarloosbaar klein is.[^322] Om de privésleutel beter leesbaar te maken, kan deze worden opgeslagen of onthouden als een seed phrase van twaalf woorden. Met de privésleutel kun je een openbare sleutel en het bijbehorende adres genereren, waarop anderen bitcoin kunnen storten. Hoewel de openbare sleutel en het adres afgeleid zijn van de privésleutel, is het proces niet omkeerbaar; niemand kan de privésleutel terugleiden uit de openbare sleutel of het adres. Alleen de eigenaar kent namelijk zijn privésleutel, en daarmee kan hij een transactie ondertekenen om bitcoin (of fracties daarvan) van zijn adres naar dat van een ander over te maken.

Nadat een eigenaar een transactie heeft geïnitieerd en ondertekend, wordt deze 'wachtende' transactie – de verplaatsing van bitcoin van het eigen adres naar dat van iemand anders (of zelfs tussen meerdere eigen en/of externe adressen) – doorgegeven aan het netwerk. Iedere node houdt een wachtrij bij van nog niet verwerkte transacties, de zogenoemde 'mempool' (afkorting van 'memory pool'). Daarnaast slaat elke node de volledige geschiedenis op van alle voorgaande blokken en daarin opgenomen transacties, vanaf het genesisblok. Zo beschikt elke node over het complete grootboek en de volledige transactiegeschiedenis. Een delver (of een groep delvers) die de puzzel van het vorige blok succesvol oplost, doorloopt vervolgens de mempool en selecteert enkele transacties om aan het nieuw te creëren blok toe te voegen. Afhankelijk van de complexiteit van de transacties kan ieder blok duizenden transacties omvatten. Verzenders moeten een transactiekost toevoegen, zodat delvers gestimuleerd worden hun blok te vullen met de transacties die de hoogste vergoedingen bieden. Tijdens drukke periodes zorgt een hogere transactiekost er doorgaans voor dat een transactie sneller in een blok wordt opgenomen. En wanneer een delver erin slaagt een blok succesvol te creëren, ontvangt hij zowel een bloksubsidie (een vastgesteld aantal nieuw gegenereerde munten per blok) als de bijbehorende transactiekosten.

Zodra een delver een nieuw blok heeft aangemaakt, wordt dit naar het netwerk van nodes verzonden. De nodes controleren of het blok voldoet aan de netwerkregels – zoals de maximale hoeveelheid data per blok en het maximum aantal nieuw aan te maken munten (de bloksubsidie). Als een node bevestigt dat het blok geldig is, slaat deze het op en verspreidt het verder naar andere nodes. Binnen korte tijd wordt het nieuwe blok door alle nodes geverifieerd en opgeslagen. De complete geschiedenis van alle blokken en bijbehorende transacties staat bekend als de 'blockchain' en wordt op iedere node opgeslagen. Wereldwijd draaien tienduizenden nodes die elk het volledige grootboek, inclusief alle transacties sinds het genesisblok, bewaren.

![Schematische voorstelling van delvers en de blockchain](/figures/20-A.png){width=100%}

Als twee delvers er ongeveer gelijktijdig in slagen de laatste puzzel op te lossen, kan dit leiden tot een tijdelijke splitsing van de keten. Sommige nodes ontvangen eerst 'blok A' van de ene delver, terwijl andere nodes eerst 'blok B' van een andere delver te zien krijgen. Deze blokken worden vervolgens naar de peer-nodes verzonden. Afhankelijk van welk blok men het eerst ontvangt, beginnen sommige delvers met het oplossen van de puzzel van 'blok A' en anderen van 'blok B'. Uiteindelijk lost een delver één van de puzzels op – stel dat dat 'blok B' is – waardoor deze keten langer wordt dan die van 'blok A'. Zodra deze informatie zich door het netwerk verspreidt, wordt 'blok B' de dominante blockchain én wordt 'blok A' als een zogeheten orphan block verworpen, zodat de keten weer tot één consensusnetwerk terugkeert. Nodes hanteren namelijk standaard de langste blockchain die voldoet aan de netwerkregels als basis voor hun verdere werking.

Alle transacties binnen Bitcoin zijn van nature probabilistisch. In de praktijk wordt een transactie echter als steeds definitiever beschouwd naarmate deze dieper in de blockchain wordt 'begraven'. Dit komt omdat het exponentieel meer rekenkracht vergt om een alternatieve keten te creëren die op een eerder blok is gebouwd en zwaarder is dan de bestaande blockchain. Een transactie die slechts in één blok is opgenomen, kan bijvoorbeeld nog worden teruggedraaid als elders gelijktijdig een langere keten ontstaat. Als de transactie twee of drie blokken diep ligt, is de kans op terugdraaien veel kleiner, en met zes of meer bevestigingen is een terugdraaiing vrijwel uitgesloten. Deze bevestigingsniveaus kunnen in de toekomst veranderen als er pogingen worden ondernomen tot censuur of dubbele-uitgavenaanvallen door goed gefinancierde aanvallers, waardoor gebruikers mogelijk langer moeten wachten. Hoe groter en belangrijker een transactie is, des te crucialer het is te wachten tot er meerdere blokken bovenop het betreffende blok zijn toegevoegd.

Het netwerk bewaakt de snelheid waarmee nieuwe blokken aan de blockchain worden toegevoegd, met als doel gemiddeld elke tien minuten een nieuw blok te produceren. Stijgt de totale rekenkracht van het netwerk, dan worden de puzzels sneller opgelost en verschijnen er blokken in een sneller tempo. Verlaat daarentegen een deel van de rekenkracht het netwerk, dan vertraagt de blokcreatie. Om hierop in te spelen controleert het netwerk elke 2.016 blokken (ongeveer om de twee weken) de gemiddelde bloktijd en past de moeilijkheidsgraad van de puzzel aan, zodat de gemiddelde bloktijd weer op tien minuten komt te liggen. Zo blijft de blokproductie stabiel, ongeacht schommelingen in de beschikbare rekenkracht.

Hoe meer nodes er actief zijn op het netwerk, des te decentraler de handhaving van de netwerkrichtlijnen is en dus des te beter het netwerk bestand is tegen ongewenste wijzigingen. Evenzo maakt een grotere hoeveelheid rekenkracht het voor een vijandige partij duurder om het netwerk aan te vallen – bijvoorbeeld door eerdere transacties doelbewust terug te draaien of nieuwe transacties te censureren. Indien een entiteit of groep erin slaagt meer dan 50% van de totale rekenkracht te beheersen (wat momenteel miljarden dollars aan apparatuur en elektriciteit vergt), kan zij het netwerk in principe op elke gewenste wijze censureren. Zij zijn echter niet in staat om de regels van het netwerk zomaar te wijzigen, omdat deze door de node‑operators worden gehandhaafd. In een dergelijk scenario kunnen netwerkgebruikers reageren door meer rekenkracht aan het netwerk toe te voegen, zodat de meerderheid van gunstige deelnemers hersteld wordt en de censuur teniet wordt gedaan.

Ontwikkelaars over de hele wereld kunnen bijdragen door updates voor te stellen van de Bitcoin nodesoftware. Een wisselend team van vrijwilligers organiseert, beoordeelt en publiceert deze updates, waarna de node‑operators kunnen beslissen deze al dan niet te installeren. Ontwikkelaars hebben geen mogelijkheid om node‑operators te verplichten een update te accepteren. Op het moment van schrijven is er één primaire implementatie van de Bitcoin nodesoftware, bekend als Bitcoin Core, maar er bestaan tevens andere implementaties van diverse ontwikkelaars die zowel onderling als met Bitcoin Core compatibel zijn. Omdat de code open‑source is, kunnen node‑operators er ook voor kiezen af te wijken van de huidige dominante implementatie als zij vinden dat deze hun belangen niet langer voldoende dient.

Een 'clientupdate' behelst kleine aanpassingen aan Bitcoin Core of andere Bitcoin clientapplicaties. Aangezien besturingssystemen in de loop der tijd veranderen, is het noodzakelijk de clientsoftware compatibel te houden. Een clientupdate wijzigt niet de consensusregels van het Bitcoinnetwerk, maar actualiseert voornamelijk andere onderdelen van de software, zodat het beheer van een node eenvoudiger en veiliger wordt.

Een 'soft fork' betreft een achterwaarts compatibele wijziging van de consensusregels van het netwerk. Dit houdt in dat nodes die upgraden naar de nieuwe software, blijven communiceren met oudere nodes die nog niet zijn bijgewerkt. Concreet wordt met een soft fork de bestaande set regels licht aangescherpt. Een voorbeeld hiervan is het verkleinen van de maximale blokgrootte: blokken die volgens deze nieuwe update worden aangemaakt, voldoen nog steeds aan de eerdere regels, maar zijn onderworpen aan strengere voorwaarden. Historisch gezien is Bitcoin meerdere keren via soft forks bijgewerkt, wat leidde tot optimalisatie van de code en de toevoeging van enkele nieuwe functies. Ter vergelijking: USB‑2.0‑apparaten zijn compatibel met bestaande USB‑1.0‑poorten, maar bieden extra functionaliteiten aan gebruikers die upgraden naar USB‑2.0, net zoals USB‑3.0‑apparaten meer mogelijkheden bieden terwijl zij achterwaarts compatibel blijven.

Een 'hard fork' is een wijziging van de consensusregels die niet achterwaarts compatibel is. Dit betekent dat iedere node die de nieuwe software gebruikt, niet langer werkt volgens een regelsysteem dat met het bestaande netwerk overeenstemt. Een voorbeeld hiervan is het verhogen van de limiet voor de blokgrootte: blokken die met de nieuwe software worden aangemaakt, voldoen niet meer aan de oudere regels en worden door het netwerk afgewezen. Andere voorbeelden van hard forks omvatten het verhogen van het totale aantal beschikbare munten of het versnellen van het tempo waarin nieuwe munten per blok worden gecreëerd. Bestaande nodes zullen dergelijke blokken automatisch afwijzen. Dit is vergelijkbaar met het introduceren van een nieuwe, incompatibele communicatiestandaard die niet functioneert met de huidige USB‑poorten.

Een niet‑compatibele update, oftewel een hard fork, leidt tot de creatie van een apart grootboeknetwerk met aanzienlijk minder nodes en rekenkracht, en wordt niet als 'Bitcoin' herkend door het bestaande netwerk – tenzij een overweldigende meerderheid van de nodes en delvers besluit de nieuwe niet‑compatibele regels over te nemen. Bij een hard fork wordt het grootboek effectief gekopieerd, zodat elke houder van een privésleutel zijn bitcoin behoudt op het oorspronkelijke grootboek én tevens toegang krijgt tot een equivalent aantal munten op het nieuwe grootboek. Voortaan wordt het succes van een hard fork bepaald door marktwerking: iedere houder heeft dan beide munten, al zal de minoritaire fork doorgaans beduidend minder marktwaarde hebben. De geschiedenis van alle transacties vóór de fork blijft identiek in beide grootboeken, maar vanaf het splitspunt kunnen de grootboeken door de invoer van nieuwe transacties uiteen gaan lopen. Als een gebruiker ervan overtuigd is dat de ene fork zal overwinnen, kan hij de munten van de andere variant verkopen en extra munten kopen van de winnende fork. Hebt hij geen sterke voorkeur, dan kan hij beide munten aanhouden en afwachten tot de situatie zich stabiliseert, waarna de waarde van de minderheidsfork uiteindelijk in het hoofdnetwerk wordt geabsorbeerd. Er zijn talloze hard forks geweest uit het hoofdnetwerk van Bitcoin, en op het moment van schrijven heeft de grootste daarvan slechts ongeveer 0,5% van de totale marktkapitalisatie van het Bitcoinnetwerk. De gevestigde fork geniet bovendien een inherent voordeel doordat deze al compatibel is met het bestaande node‑netwerk.

Satoshi programmeerde Bitcoin zo dat elke tien minuten gemiddeld 50 nieuwe munten worden gegenereerd voor een delver die succesvol een blok creëert. Het aantal nieuwe munten wordt vervolgens elke 210.000 blokken (ongeveer elke vier jaar) gehalveerd: na vier jaar daalde dit naar 25 munten, daarna naar 12,5, en vervolgens naar 6,25, enzovoort. Deze afnemende bloksubsidie is vanaf de software-initialisatie vastgelegd. Volgens de onderliggende wiskunde nadert het netwerk uiteindelijk een limiet van 21 miljoen munten, en op het moment van schrijven zijn er bijna 19,5 miljoen munten in omloop.

![Inflatie van Bitcoin en totale (verwachte) geldhoeveelheid](/figures/20-B.png){width=100%}

[^323]

Hoewel dit op het eerste gezicht complex lijkt, is het veel minder ingewikkeld dan de gedetailleerde werking van het wereldwijde banksysteem. Dat systeem omvat immers de complexe interacties tussen financiële entiteiten voor de verwerking van dollartransacties en de nachtelijke kredietregelingen tussen banken via overeenkomsten om dollars terug te kopen en soortgelijke contracten. In vergelijking daarmee is de basislaag van het Bitcoinnetwerk eenvoudig: het merendeel wordt weggelaten of geabstraheerd voor de gebruiker. Het feit dat een volledige node op een verouderde laptop kan draaien, toont aan hoe simpel de basis is; het netwerk bestaat uit een groep relatief eenvoudige nodes die elke tien minuten gezamenlijk de staat van het grootboek bevestigen. Deze details zijn echter belangrijk voor potentiële vroege gebruikers die willen bepalen of dit netwerk waarschijnlijk succesvol zal zijn, of wat deze technologie betekent voor het concept van geld in de toekomst.

Tegenwoordig zijn er talloze ondertekeningsapparaten en mobiele wallet-apps waarmee gebruikers moeiteloos hun privésleutels, adressen en nodefuncties kunnen beheren, zonder zich zorgen te maken over de technische details – net zoals een autobezitter niet zelf monteur hoeft te zijn. Deze producten worden door diverse teams en ondernemingen wereldwijd ontwikkeld; iedereen kan nieuwe toepassingen en diensten creëren, zolang ze compatibel zijn met het open-source Bitcoinnetwerk.

Gebruikers kunnen zelf bepalen in hoeverre zij technisch betrokken willen zijn bij het Bitcoinnetwerk. Draaien zij hun eigen node en beheren zij hun privésleutels, dan kunnen zij de totale voorraad van het netwerk monitoren, deelnemen aan de netwerkconsensus, peer-to-peer-transacties uitvoeren en hun privacy waarborgen, zonder dat een gecentraliseerde partij ingrijpt. Tenzij een individu meer dan de helft van de totale rekenkracht beheerst (of met geweld optreedt), kan niemand voorkomen dat node-operators transacties verzenden of ontvangen. Bovendien kunnen gebruikers diverse privacy- en anonimiseringstechnieken toepassen en de bijbehorende software direct op andere netwerklagen draaien.

Op een iets lager niveau kan iemand ervoor kiezen om zijn privésleutels zelf te bewaren, maar wel gebruik te maken van een node die door een derde partij wordt beheerd. Dit betekent dat er enigszins concessies worden gedaan op het gebied van privacy en controle, maar het biedt de mogelijkheid om de eigen munten te beheren en — indien gewenst — op elk moment een eigen node op te zetten. Deze middenweg voorziet gebruikers in veel keuzemogelijkheden om na verloop van tijd meer betrokken te raken.

Een nog lager niveau betreft het gebruik van een bewaardienst, waarbij een derde partij de privésleutels voor de gebruiker beheert. Er bestaan diverse wallet-apps en financiële dienstverleners die bitcoin voor klanten aanhouden en hen in staat stellen om eenvoudig bitcoin over te maken. Hoewel dit erg handig is, brengt het ook privacyproblemen en tegenpartijrisico's met zich mee, zoals beperkingen bij het opnemen of verzenden van munten naar bepaalde adressen. Nieuwe technologieën, zoals het open-source Fedimint-protocol, bieden echter mogelijkheden voor geautomatiseerde en particuliere bewaarregelingen.

Er zijn ook hybride oplossingen dankzij de multi-signature technologie. De digitale handtekening die nodig is om bitcoin vanaf een adres te versturen, kan in stukken worden gebroken. Zo kunnen bijvoorbeeld twee van de drie nodig zijn om een transactie te ondertekenen. Dit is handig voor extra beveiliging of nalatenschapsplanning. Iemand kan één sleutel bij zich houden, een tweede sleutel ergens anders veilig bewaren (misschien bij een vertrouwd familielid of juridische vertegenwoordiger of in een versleuteld en wachtwoordbeveiligd bestand), en een derde sleutel bij een bitcoingerelateerde financiële dienstverlener. Dit biedt bescherming tegen het verliezen van één sleutel en biedt de gebruiker enkele voordelen van een bewaarservice zonder dat de bewaarder volledige controle krijgt over hun munten. Dit type hybride bewaring is onmogelijk met contant geld, goud of andere soorten niet-versleuteld geld.

Nu we aan het einde van dit hoofdstuk komen, moeten we ons afvragen: 'Wie beheert het grootboek voor Bitcoin?'.

Het eerste antwoord is dat de tienduizenden gebruikers die nodes draaien het grootboek beheren en iedereen met een eenvoudige laptop (of vergelijkbare hardware) en een standaard internetverbinding kan deelnemen als node-operator. Node-operators zijn degenen die de volledige geschiedenis van het grootboek opslaan en gezamenlijk de software onderhouden die het netwerk draait en de netwerkregelshandhaaft voor nieuwe blokken die door miners aan de blockchain worden toegevoegd.

Het tweede antwoord is dat delvers een belangrijke rol spelen in het bijwerken van het grootboek. Delvers gebruiken elektriciteit en gespecialiseerde processors om het recht te verdienen om nieuwe transacties aan het grootboek toe te voegen. Een enkele delver of een groep delvers die meer dan 50% van de actieve rekenkracht op het netwerk vertegenwoordigt, kan transacties censureren of recente transacties terugdraaien die gebruikers als definitief beschouwden. Ze kunnen specifieke transacties censureren of het netwerk aanvallen door lege blokken te minen om alle toekomstige transacties te censureren. Als dit gebeurt, is het niet noodzakelijk een permanent probleem; meer rekenkracht kan online worden gebracht door gebruikers van het systeem, die extra gestimuleerd worden door een piek in transactiekosten door gecensureerde gebruikers, om collectief meer dan 50% van de rekenkracht van het netwerk te herwinnen.

Ontwikkelaars hebben invloed, maar geen directe macht over het grootboek, omdat ze geen enkele node-operator kunnen dwingen om een software-update te accepteren. Als ontwikkelaars een update maken die de node-operators niet bevalt, accepteren zij die update niet. Node-operators blijven dan hun bestaande software gebruiken en kunnen besluiten om andere ontwikkelaars te ondersteunen voor het maken van andere updates. Veel node-operators wachten jaren na het uitkomen van een update voordat ze die installeren, om zeker te weten dat deze stabiel en foutloos is. Ontwikkelaars zijn nog steeds van groot belang voor het netwerk. Hun deskundigheid in het maken van achterwaarts-compatibele updates die gebruikers wensen, heeft Bitcoin veiliger en schaalbaarder gemaakt. De ontwikkelaars zijn een steeds veranderende groep vrijwilligers. Veel van hen worden financieel ondersteund door bedrijven binnen het ecosysteem. Ze zorgen ervoor dat de node-software compatibel blijft met de steeds veranderende moderne computeromgevingen.

In tegenstelling tot banken, centrale banken en financiële systemen met fiatgeld, is er geen entiteit die eenzijdig het Bitcoingrootboek kan devalueren. Er is geen centrale node die een miljoen nieuwe munten voor zichzelf kan creëren. Niemand kan de munten van een gebruiker bemachtigen, tenzij ze zijn privésleutel weten te verkrijgen (die kan worden beschermd met wachtwoorden en/of multisignature-beveiliging) of tenzij ze de gebruiker dwingen om zijn munten over te dragen. Het grootboek is transparant, objectief en beveiligd door reële middelen in de vorm van elektriciteit en gespecialiseerde processors.

[^307]: James Blanchard, *An Interview with F.A. Hayek*, 1 mei 1984.
[^308]: Aaron van Wirdum, *The Genesis Book*, hoofdstukken 6-13.
[^309]: David Chaum, *Computer Systems Established, Maintained and Trusted by Mutually Suspicious Groups*.
[^310]: Chaum, *Blind Signatures for Untraceable Payments*.
[^311]: Julie Pitta, *Requiem for a Bright Idea*, Forbes, 1 november 1999.
[^312]: Kim Zetter, *Bullion and Bandits*, Wired, 9 juni 2009.
[^313]: van Wirdum, *The Genesis Book*, hoofdstukken 10-11 en hoofdstuk 13.
[^314]: Nakamoto, *Bitcoin*.
[^315]: Nakamoto, *Emails*.
[^316]: Nakamoto, *Bitcoin: P2P E-Cash Paper*.
[^317]: Mempool.space, *Genesis: 0*.
[^318]: Hal Finney, *Running bitcoin*, Twitter, 10 januari 2009; Mempool.space, *Block: 170*.
[^319]: Pete Rizzo, *The Last Days of Satoshi*, Bitcoin Magazine, 26 april 2021.
[^320]: Graham Krizek, *Every Company Will Be a Lightning Company*, Medium, 21 juni 2023.
[^321]: Satoshi Nakamoto, *Bitcoin Open Source Implementation of P2P Currency*.
[^322]: Yan Pritzker, *Inventing Bitcoin: The Technology Behind the First Truly Scarce and Decentralized Money Explained*, 50-53; Matt Cutler, *Guessing a Private Key*, Blocknative, 26 juni 2019.
[^323]: Blockchain.com, *Total Circulating Bitcoin*.
